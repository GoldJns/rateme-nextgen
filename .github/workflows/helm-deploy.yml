name: Helm deployment

on:
  push:
    branches: ["main", "feature/*"]
    paths-ignore:
      - "*.md"
jobs:
  helm-deploy:
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v3
      - name: Deploy
        uses: WyriHaximus/github-action-helm3@v3
        with:
          exec: chmod go-r ~/.kube/config && chmod +x ./deployment/deployAll.sh && ./deployment/deployAll.sh ${NAMESPACE}
          kubeconfig: "${{ secrets.KUBECONFIG }}"
          overrule_existing_kubeconfig: "true"
